import{S as A}from"./SellInfoModal-6d58a9f5.js";import{P as E}from"./PaginationComponent-5645ad98.js";import{_ as f,o as n,c as d,b as t,q as m,t as c,m as w,r as h,F as P,h as T,d as p}from"./index-2149ffc1.js";import{u as v}from"./login-cf5c991e.js";import{M as g}from"./bootstrap.esm-434bcbc7.js";const{VITE_APP_URL:I,VITE_APP_PATH:V}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_APP_PATH:"brad5566",BASE_URL:"/shrimpMap/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k={props:["tempProduct","getProductsList"],methods:{delProduct(){this.$http({method:"delete",url:`${I}api/${V}/admin/article/${this.tempProduct.id}`}).then(e=>{alert(e.data.message),this.$emit("closeModal","del"),this.getProductsList()}).catch(e=>{console.log(e),alert(e.data.message)})}}},y={id:"delSellModal",ref:"delSellModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delSellModal","aria-hidden":"true"},L={class:"modal-dialog"},x={class:"modal-content border-0"},C=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delSellModal",class:"modal-title"},[t("span",null,"刪除店家")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R={class:"modal-body text-dark"},U={class:"text-danger text-dark"},D={class:"modal-footer"},N=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function B(e,l,i,S,a,s){return n(),d("div",y,[t("div",L,[t("div",x,[C,t("div",R,[m(" 是否刪除 "),t("strong",U,c(i.tempProduct.store_name),1),m(" 店家(刪除後將無法恢復)。 ")]),t("div",D,[N,t("button",{type:"button",onClick:l[0]||(l[0]=(...r)=>s.delProduct&&s.delProduct(...r)),class:"btn btn-danger"}," 確認刪除 ")])])])],512)}const H=f(k,[["render",B]]),{VITE_APP_URL:u,VITE_APP_PATH:_}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_APP_PATH:"brad5566",BASE_URL:"/shrimpMap/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},O={data(){return{articles:[],page:{},tempSell:{},isNew:!1,time:""}},components:{SellInfoModal:A,PaginationComponent:E,delSell:H},methods:{...w(v,["checkLogin"]),getArticles(e=1){this.$http({method:"get",url:`${u}api/${_}/admin/articles/?page=${e}`}).then(l=>{this.articles=l.data.articles,this.page=l.data.pagination}).catch(l=>{console.log(l)})},openModal(e,l){e==="edit"?(this.tempSell={...l},this.isNew=!1,this.sellModal.show()):e==="delete"?(this.tempSell={...l},this.dellSell.show()):e==="new"&&(this.tempSell={},this.isNew=!0,this.sellModal.show())},updateSell(){if(!this.isNew)this.$http({method:"put",url:`${u}api/${_}/admin/article/${this.tempSell.id}`,data:{data:this.tempSell}}).then(e=>{alert(e.data.message),this.sellModal.hide(),this.getArticles()}).catch(e=>{console.log(e)});else{const e=new Date,l=Math.floor(e.getTime()/1e3);this.tempSell.create_at=l,this.$http({method:"post",url:`${u}api/${_}/admin/article`,data:{data:this.tempSell}}).then(i=>{alert("已新增店家"),this.sellModal.hide(),this.getArticles()}).catch(i=>{console.log(i)})}},closeModal(e){e==="del"&&this.dellSell.hide()}},mounted(){this.checkLogin(),this.getArticles(),this.sellModal=new g(this.$refs.SellInfoModal.$refs.sellInfoModal),this.dellSell=new g(this.$refs.dellSell.$refs.delSellModal)}},F={class:"container"},q={class:"text-end mt-4"},j={class:"table mt-4 text-white"},z=t("thead",null,[t("tr",null,[t("th",{width:"70"}," 城市 "),t("th",null,"店名"),t("th",null," 時間 "),t("th",null," 公開 "),t("th",null," 編輯 ")])],-1),G={key:0,class:"text-success"},J={key:1},K={class:"btn-group"},Q=["onClick"],W=["onClick"];function X(e,l,i,S,a,s){const r=h("PaginationComponent"),b=h("SellInfoModal"),M=h("delSell");return n(),d(P,null,[t("div",F,[t("div",q,[t("button",{onClick:l[0]||(l[0]=o=>s.openModal("new")),class:"btn btn-primary"}," 建立新的文章 ")]),t("table",j,[z,t("tbody",null,[(n(!0),d(P,null,T(a.articles,o=>(n(),d("tr",{key:o.id},[t("td",null,c(o.title),1),t("td",null,c(o.store_name),1),t("td",null,c(e.$filters.date(o.create_at)),1),t("td",null,[o.isPublic?(n(),d("span",G,"啟用")):(n(),d("span",J,"不啟用"))]),t("td",null,[t("div",K,[t("button",{onClick:$=>s.openModal("edit",o),type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,Q),t("button",{onClick:$=>s.openModal("delete",o),type:"button",class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,W)])])]))),128))])])]),p(r,{pages:a.page,onEmitPages:s.getArticles},null,8,["pages","onEmitPages"]),p(b,{ref:"SellInfoModal",onUpdateSell:s.updateSell,sell:a.tempSell,isNew:a.isNew},null,8,["onUpdateSell","sell","isNew"]),p(M,{ref:"dellSell",onCloseModal:s.closeModal,tempProduct:a.tempSell,getProductsList:s.getArticles},null,8,["onCloseModal","tempProduct","getProductsList"])],64)}const st=f(O,[["render",X]]);export{st as default};
